<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Diferencia entre Primer y Último Día del Mes</title>
</head>
<body>
<h2>Diferencia entre Primer y Último Día del Mes</h2>
<select id="anioSelect">
    <!-- Opciones para seleccionar el año -->
</select>
<select id="mesSelect">
    <!-- Opciones para seleccionar el mes -->
</select>
<button onclick="calcularDiferenciaMes()">Calcular Diferencia</button>
<div id="diferenciaResultados"></div>

<script>
    function calcularDiferenciaMes() {
        const anioSeleccionado = document.getElementById('anioSelect').value;
        const mesSeleccionado = document.getElementById('mesSelect').value;

        // Filtra las monedas del año y mes seleccionados (asumiendo que los datos están en la lista 'monedas')
        const monedasFiltradas = monedas.filter(moneda => {
            const fecha = new Date(moneda.fecha);
            return fecha.getFullYear() === parseInt(anioSeleccionado) && fecha.getMonth() + 1 === parseInt(mesSeleccionado);
        });

        // Calcula la diferencia entre el primer y último día del mes
        const primerDiaValor = monedasFiltradas[0].valor;
        const ultimoDiaValor = monedasFiltradas[monedasFiltradas.length - 1].valor;
        const diferenciaEnPesos = ultimoDiaValor - primerDiaValor;

        // Calcula el promedio de valores del mes
        const sumaValores = monedasFiltradas.reduce((suma, moneda) => suma + moneda.valor, 0);
        const promedioValores = sumaValores / monedasFiltradas.length;

        // Calcula la moda de valores del mes
        const contadorValores = {};
        monedasFiltradas.forEach(moneda => {
            const valor = moneda.valor.toFixed(3);
            contadorValores[valor] = (contadorValores[valor] || 0) + 1;
        });

        let modaValores = [];
        let maxFrecuencia = 0;

        for (const valor in contadorValores) {
            const frecuencia = contadorValores[valor];
            if (frecuencia > maxFrecuencia) {
                modaValores = [valor];
                maxFrecuencia = frecuencia;
            } else if (frecuencia === maxFrecuencia) {
                modaValores.push(valor);
            }
        }

        const resultadosDiv = document.getElementById('diferenciaResultados');
        resultadosDiv.innerHTML = `Año seleccionado: ${anioSeleccionado}<br>
                                     Mes seleccionado: ${mesSeleccionado}<br>
                                     Diferencia entre el primer y último día: ${diferenciaEnPesos.toFixed(3)}<br>
                                     Promedio de valores del mes: ${promedioValores.toFixed(3)}<br>
                                     Moda de valores del mes: ${modaValores.join(', ')}`;
    }
</script>

</body>
</html>
